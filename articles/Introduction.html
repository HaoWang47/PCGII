<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PCGII">
<title>Introduction • PCGII</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="PCGII">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PCGII</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Introduction.html">Introduction</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction</h1>
            
      
      
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p><code>PCGII</code> is an R package developed for
Information-incorporated Gene Network Construction with FDR Control.
PCGII stands for <strong>P</strong>artial <strong>C</strong>orrelation
<strong>G</strong>raphs with <strong>I</strong>nformation
<strong>I</strong>ncorporation.</p>
<p>To start using PCGII, prepare your gene expression data and your
prior knowledge about gene-gene direct associations in the target
network. Two methods were implemented in the package,
<strong>PCGII</strong> for the case when you have prior knowledge and
<strong>CLEVEL</strong> for the case when you do not have prior
knowledge. You can select one of two methods to construct the gene
network. Incorporating false information could lead to an inflation of
the empirical FDR. As a result, we strongly recommend incorporating only
high-confidence information in real data applications.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github("HaoWang47/PCGII")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haowang47.github.io/PCGII/">PCGII</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strimmerlab.github.io/software/corpcor/" class="external-link">corpcor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-8</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'igraph'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     decompose, spectrum</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.4.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">lubridate</span>::<span style="color: #00BB00;">%--%()</span>      masks <span style="color: #0000BB;">igraph</span>::%--%()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">as_data_frame()</span> masks <span style="color: #0000BB;">tibble</span>::as_data_frame(), <span style="color: #0000BB;">igraph</span>::as_data_frame()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">compose()</span>       masks <span style="color: #0000BB;">igraph</span>::compose()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">crossing()</span>      masks <span style="color: #0000BB;">igraph</span>::crossing()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">expand()</span>        masks <span style="color: #0000BB;">Matrix</span>::expand()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span>        masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>           masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">pack()</span>          masks <span style="color: #0000BB;">Matrix</span>::pack()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">simplify()</span>      masks <span style="color: #0000BB;">igraph</span>::simplify()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">unpack()</span>        masks <span style="color: #0000BB;">Matrix</span>::unpack()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">010120000</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-network-and-prepare-data">Simulate Network and Prepare Data<a class="anchor" aria-label="anchor" href="#simulate-network-and-prepare-data"></a>
</h2>
<p>Three methods of generating a network structure were included in
PCGII, including Scale Free Network Structure, Random Connection Network
Structure, and Block Diagonal Network Structure. In this section, we
will illustrate what are expected during data preparation. We will start
with a network with 100 nodes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Simulate precision matrix as your true network structure</span></span>
<span><span class="va">N_nodes</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">N_samples</span> <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="va">Omega</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_sf_precision_mat.html">make_sf_precision_mat</a></span><span class="op">(</span>e <span class="op">=</span> <span class="fl">1</span>, p <span class="op">=</span> <span class="va">N_nodes</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Display the true network</span></span>
<span><span class="va">nodenames</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">N_nodes</span></span>
<span><span class="va">links</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">Omega</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Omega</span><span class="op">!=</span><span class="fl">0</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">links</span><span class="op">)</span> <span class="co"># display number of connections, two columns correspond to the connected nodes</span></span>
<span><span class="co">#&gt; [1] 99  2</span></span>
<span><span class="va">my_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span>d<span class="op">=</span><span class="va">links</span>, vertices<span class="op">=</span><span class="va">nodenames</span>, directed<span class="op">=</span><span class="cn">F</span><span class="op">)</span> </span>
<span><span class="va">Ecolrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray50"</span><span class="op">)</span></span>
<span><span class="va">Vcolrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_net</span>, </span>
<span>     edge.arrow.size<span class="op">=</span><span class="fl">.5</span>, </span>
<span>     edge.color<span class="op">=</span><span class="va">Ecolrs</span>,</span>
<span>     vertex.frame.color<span class="op">=</span><span class="st">"#ffffff"</span>,</span>
<span>     vertex.label.color<span class="op">=</span><span class="st">"black"</span>,</span>
<span>     vertex.size<span class="op">=</span><span class="fl">3</span>,</span>
<span>     layout<span class="op">=</span><span class="fu"><a href="https://r.igraph.org/reference/layout_nicely.html" class="external-link">layout.auto</a></span><span class="op">(</span><span class="va">my_net</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Introduction_files/figure-html/display%20the%20true%20network-1.png" alt="True Network Connections, auto-layout" width="80%"><p class="caption">
True Network Connections, auto-layout
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">my_net</span>, </span>
<span>     edge.arrow.size<span class="op">=</span><span class="fl">.5</span>, </span>
<span>     edge.color<span class="op">=</span><span class="va">Ecolrs</span>,</span>
<span>     vertex.frame.color<span class="op">=</span><span class="st">"#ffffff"</span>,</span>
<span>     vertex.label.color<span class="op">=</span><span class="st">"black"</span>,</span>
<span>     vertex.size<span class="op">=</span><span class="fl">3</span>,</span>
<span>     layout<span class="op">=</span><span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.circle</a></span><span class="op">(</span><span class="va">my_net</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Introduction_files/figure-html/unnamed-chunk-2-1.png" alt="True Network Connections, circle-layout" width="80%"><p class="caption">
True Network Connections, circle-layout
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Simulate Normal data</span></span>
<span><span class="va">Sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">Omega</span><span class="op">)</span></span>
<span><span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.01</span>, to <span class="op">=</span> <span class="fl">0.99</span>, length.out <span class="op">=</span> <span class="va">N_nodes</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">norm_data</span> <span class="op">=</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N_samples</span>, mean <span class="op">=</span> <span class="va">mu</span>, sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="co">## Convert simulated normal data to expression count data</span></span>
<span><span class="va">norm_data</span><span class="op">[</span><span class="va">norm_data</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="va">Exp_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">norm_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Exp_data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    3    1    3    1    2    3     2</span></span>
<span><span class="co">#&gt; [2,]    1    1    1    2    1    1    2    2    1     2</span></span>
<span><span class="co">#&gt; [3,]    0    1    1    1    3    1    0    3    1     4</span></span>
<span><span class="co">#&gt; [4,]    0    0    1    2    1    1    3    3    3     2</span></span>
<span><span class="co">#&gt; [5,]    3    0    2    4    0    2    1    4    0     0</span></span>
<span><span class="co">#&gt; [6,]    1    1    1    0    2    2    2    0    5     2</span></span></code></pre></div>
<p>For illustration, we will randomly select a subset of true
connections and use them as prior knowledge. It should be carefully
considered if such prior connections are undirected (i.e. A-B OR A-&gt;B
&amp; B-&gt;A) in practice. Under the PCGII framework, it is recommended
to use undirected connections as prior information.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_links</span> <span class="op">=</span> <span class="va">links</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">links</span><span class="op">)</span>, <span class="fl">.2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">links</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">types</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">types</span><span class="op">[</span><span class="va">prior_links</span><span class="op">]</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># 1 for unknown true connections, 2 for known prior connections</span></span>
<span><span class="va">undirected_prior_links</span> <span class="op">=</span> <span class="fu"><a href="../reference/undirected_prior.html">undirected_prior</a></span><span class="op">(</span><span class="va">prior_links</span><span class="op">)</span></span>
<span><span class="va">prior_net</span> <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span>d<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">links</span>,<span class="va">types</span><span class="op">)</span>, vertices<span class="op">=</span><span class="va">nodenames</span>, directed<span class="op">=</span><span class="cn">F</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning in cbind(links, types): number of rows of result is not a multiple of</span></span>
<span><span class="co">#&gt; vector length (arg 2)</span></span>
<span><span class="va">Ecolrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey90"</span>, <span class="st">"grey10"</span><span class="op">)</span> <span class="co"># dark grey shows known prior connections</span></span>
<span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">prior_net</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">=</span> <span class="va">Ecolrs</span><span class="op">[</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">prior_net</span><span class="op">)</span><span class="op">$</span><span class="va">types</span><span class="op">]</span></span>
<span><span class="va">Vcolrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prior_net</span>, </span>
<span>     edge.arrow.size<span class="op">=</span><span class="fl">.5</span>, </span>
<span>     vertex.frame.color<span class="op">=</span><span class="st">"#ffffff"</span>,</span>
<span>     vertex.label.color<span class="op">=</span><span class="st">"black"</span>,</span>
<span>     vertex.size<span class="op">=</span><span class="fl">3</span>,</span>
<span>     layout<span class="op">=</span><span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.circle</a></span><span class="op">(</span><span class="va">my_net</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Introduction_files/figure-html/prior-1.png" alt="Prior Network Connections, circle-layout" width="80%"><p class="caption">
Prior Network Connections, circle-layout
</p>
</div>
</div>
<div class="section level2">
<h2 id="analyses-with-pcgii-and-clevel">Analyses with PCGII and CLEVEL<a class="anchor" aria-label="anchor" href="#analyses-with-pcgii-and-clevel"></a>
</h2>
<div class="section level3">
<h3 id="pcgii-inference">PCGII Inference<a class="anchor" aria-label="anchor" href="#pcgii-inference"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixed_lamdba</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">N_nodes</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">N_samples</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">N_samples</span><span class="op">)</span></span>
<span><span class="va">PCGII.out</span> <span class="op">=</span> <span class="fu"><a href="../reference/PCGII.html">PCGII</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">Exp_data</span>, prior <span class="op">=</span> <span class="va">undirected_prior_links</span>, lambda <span class="op">=</span> <span class="va">fixed_lamdba</span><span class="op">)</span></span>
<span><span class="va">PCGII.inf</span> <span class="op">=</span> <span class="fu"><a href="../reference/inference.html">inference</a></span><span class="op">(</span><span class="va">PCGII.out</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="display-significant-connections-detected-by-pcgii">Display significant connections detected by PCGII<a class="anchor" aria-label="anchor" href="#display-significant-connections-detected-by-pcgii"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCGII_links</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">PCGII.inf</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">PCGII.inf</span><span class="op">!=</span><span class="fl">0</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">PCGII_links</span><span class="op">)</span> <span class="co"># display number of connections detected by PCGII</span></span>
<span><span class="co">#&gt; [1] 45  2</span></span>
<span><span class="va">PCGII_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span>d<span class="op">=</span><span class="va">PCGII_links</span>, vertices<span class="op">=</span><span class="va">nodenames</span>, directed<span class="op">=</span><span class="cn">F</span><span class="op">)</span> </span>
<span><span class="va">Ecolrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="va">Vcolrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PCGII_net</span>, </span>
<span>     edge.arrow.size<span class="op">=</span><span class="fl">.5</span>, </span>
<span>     edge.color<span class="op">=</span><span class="va">Ecolrs</span>,</span>
<span>     vertex.frame.color<span class="op">=</span><span class="st">"#ffffff"</span>,</span>
<span>     vertex.label.color<span class="op">=</span><span class="st">"black"</span>,</span>
<span>     vertex.size<span class="op">=</span><span class="fl">3</span>,</span>
<span>     layout<span class="op">=</span><span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.circle</a></span><span class="op">(</span><span class="va">PCGII_net</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Introduction_files/figure-html/PCGII_net-1.png" alt="Network Recovered by PCGII, circle-layout" width="80%"><p class="caption">
Network Recovered by PCGII, circle-layout
</p>
</div>
</div>
<div class="section level3">
<h3 id="clevel-inference">CLEVEL Inference<a class="anchor" aria-label="anchor" href="#clevel-inference"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CLEVEL.out</span> <span class="op">=</span> <span class="fu"><a href="../reference/clevel.html">clevel</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">Exp_data</span>, lambda <span class="op">=</span> <span class="va">fixed_lamdba</span><span class="op">)</span></span>
<span><span class="va">CLEVEL.inf</span> <span class="op">=</span> <span class="fu"><a href="../reference/inference.html">inference</a></span><span class="op">(</span><span class="va">CLEVEL.out</span>, alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="display-significant-connections-detected-by-clevel">Display significant connections detected by CLEVEL<a class="anchor" aria-label="anchor" href="#display-significant-connections-detected-by-clevel"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CLEVEL_links</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">CLEVEL.inf</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">CLEVEL.inf</span><span class="op">!=</span><span class="fl">0</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">CLEVEL_links</span><span class="op">)</span> <span class="co"># display number of connections detected by PCGII</span></span>
<span><span class="co">#&gt; [1] 38  2</span></span>
<span><span class="va">CLEVEL_net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span>d<span class="op">=</span><span class="va">CLEVEL_links</span>, vertices<span class="op">=</span><span class="va">nodenames</span>, directed<span class="op">=</span><span class="cn">F</span><span class="op">)</span> </span>
<span><span class="va">Ecolrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="va">Vcolrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">CLEVEL_net</span>, </span>
<span>     edge.arrow.size<span class="op">=</span><span class="fl">.5</span>, </span>
<span>     edge.color<span class="op">=</span><span class="va">Ecolrs</span>,</span>
<span>     vertex.frame.color<span class="op">=</span><span class="st">"#ffffff"</span>,</span>
<span>     vertex.label.color<span class="op">=</span><span class="st">"black"</span>,</span>
<span>     vertex.size<span class="op">=</span><span class="fl">3</span>,</span>
<span>     layout<span class="op">=</span><span class="fu"><a href="https://r.igraph.org/reference/layout.deprecated.html" class="external-link">layout.circle</a></span><span class="op">(</span><span class="va">CLEVEL_net</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Introduction_files/figure-html/CLEVEL_net-1.png" alt="Network Recovered by CLEVEL, circle-layout" width="80%"><p class="caption">
Network Recovered by CLEVEL, circle-layout
</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Crafted by <a href="https://haowang47.github.io/" class="external-link">Hao Wang</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
